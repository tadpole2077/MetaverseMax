
<div>
  <img *ngIf="district" src="https://play.mcp3d.com/assets/images/districts/TRX/{{ district.district_id }}.png" class="districtImg" height="210" />
  <div *ngIf="district.active_from" class="slideOutLeft">
    <p aria-live="polite">
      District Opened On:
      <span>{{ district.active_from }}</span>
    </p>
  </div>
</div>
<h3 id="tableLabel">District Report : #{{ district.district_id }} {{ district.district_name }}
  <a *ngIf="district.promotion!=null" class="showAd" role="button" (click)="showAd(district.promotion, district.promotion_start, district.promotion_end)"><i class="fas fa-ad adIcon"></i></a>
</h3>

<p *ngIf="!district"><em>Loading...</em></p>

<div>
  <div aria-live="polite" class="ownerInfo">
    <div class="ownerImgPos">
      <img *ngIf="district.owner_avatar_id>0" src="https://mcp3d.com/tron/api/image/citizen/{{ district.owner_avatar_id }}" class="ownerImgCol" height="64" />
      <img *ngIf="district.owner_avatar_id==0" src="./images/MysteryOwner.png" class="ownerImgCol" height="50" style="margin-top:0" />
    </div>
    <div class="ownerdata">
      <div>Owner: <strong>{{ district.owner_name }}</strong></div>
      <div>
        District Owner Key:
        <strong>MATIC: <a target="_blank" href="https://explorer-mainnet.maticvigil.com/address/{{ district.owner_matic }}/tokens">{{ district.owner_matic.substring(0,15) + '...' }}</a></strong>
      </div>     
    </div>
  </div>

  <div *ngIf="district.owner_matic !=''">
    <H6 aria-live="polite" style="margin-bottom:.2rem"> District Plot Use: </H6>
    <div style="margin-left:10px">
      <p aria-live="polite">
        Total: <strong>{{ district.land_count }}</strong>
        <span style="margin-left:30px">Claimed : <strong>{{ district.plots_claimed }}</strong></span>
        <span style="margin-left:30px">Built : <strong>{{ district.building_count }}</strong></span>
        <span style="margin-left:30px">Empty : <strong>{{ district.plots_claimed - district.building_count }}</strong><span style="font-size:.9em;margin-right:.6rem">(claimed)</span><strong>{{ district.land_count - district.plots_claimed}}</strong><span style="font-size:.9em;">(available)</span></span>
      </p>
    </div>
  </div>
</div>

<app-search-district class="searchDistrict" (searchDistrictEvent)="searchDistrict($event)"></app-search-district>
<app-note-modal [hidden]="!this.adShow" (hideAdEvent)="hideAd($event)"></app-note-modal>

<div class="table-container" [hidden]="!ownerSummary || !ownerSummary.length">

  <table mat-table [dataSource]="dataSourceOwnerSummary" matSort matSortStart="desc" class="table-striped mat-elevation-z8" style="width:100%; display:inline-table">
    <!--table table-striped-->
    <ng-container matColumnDef="owner_nickname">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Owner </th><!-- start="asc"-->
      <td mat-cell *matCellDef="let ownerSummary">
        <img *ngIf="ownerSummary.owner_avatar_id>0" src="https://mcp3d.com/tron/api/image/citizen/{{ ownerSummary.owner_avatar_id }}" class="ownerImgCol" height="60" />
        <img *ngIf="ownerSummary.owner_avatar_id==0" src="./images/MysteryOwner.png" class="ownerImgCol" height="50" style="margin-top:0" />
        <a class="nav-link text-dark lineAnim maticLinkCol" [routerLink]="['/owner-data']" [queryParams]="{matic: ownerSummary.owner_matic}" title="{{ ownerSummary.owner_nickname }}">
          <span class="long-text" *ngIf="ownerSummary.owner_nickname!=''">{{ ownerSummary.owner_nickname }}</span>
          <span class="short-text" *ngIf="ownerSummary.owner_nickname!=''">{{ ownerSummary.owner_nickname.substring(0,12) }}</span>
          <span class="long-text" *ngIf="ownerSummary.owner_nickname==''">{{ ownerSummary.owner_matic.substring(0,14) + '...' }}</span>
          <span class="short-text" *ngIf="ownerSummary.owner_nickname==''">{{ ownerSummary.owner_matic.substring(0,8) + '...' }}</span>
        </a>
      </td>
    </ng-container>    
    <ng-container matColumnDef="owned_plots">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> <span class="long-text">Owned plots</span><span class="short-text">Owned</span></th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.owned_plots }} </td>
    </ng-container>
    <ng-container matColumnDef="energy_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.energy_count }} x</span>
        <img src="https://play.mcp3d.com/assets/images/buildings/Energy_ThermalPower_LVL1-1.png" height="30" />
        <span class="long-text">Energy</span><span class="short-text">E</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.energy_count }} </td>
    </ng-container>
    <ng-container matColumnDef="industry_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.industry_count }} x</span>
        <img src="https://play.mcp3d.com/assets/images/buildings/MetalSmelterFactory_V2_LVL1-1.png" height="30" />
        <span class="long-text">Industry</span><span class="short-text">I</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.industry_count }} </td>
    </ng-container>
    <ng-container matColumnDef="production_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.production_count }} x</span>
        <img src="https://play.mcp3d.com/assets/images/buildings/BrickFactory_V2_LVL1-1.png" height="30" />
        <span class="long-text">Production</span><span class="short-text">P</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.production_count }} </td>
    </ng-container>
    <ng-container matColumnDef="office_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.office_count }} x</span>
        <img src="https://play.mcp3d.com/assets/images/buildings/OfficeRing_LVL1-1.png" height="30" />
        <span class="long-text">Office</span><span class="short-text">O</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.office_count }} </td>
    </ng-container>
    <ng-container matColumnDef="residential_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.residential_count }} x</span>
        <img src="https://play.mcp3d.com/assets/images/buildings/Residential3_LVL1-1.png" height="30" />
        <span class="long-text">Residential</span><span class="short-text">R</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.residential_count }} </td>
    </ng-container>
    <ng-container matColumnDef="poi_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.poi_count }} x</span>
        <img src="./images/OfficeMonument.PNG" height="30" />
        <span>POI</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.poi_count }} </td>
    </ng-container>
    <ng-container matColumnDef="commercial_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.commercial_count }} x</span>
        <img src="https://play.mcp3d.com/assets/images/buildings/Blockmart_V2_LVL1-1.png" height="30" />
        <span class="long-text">Commercial</span><span class="short-text">C</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.commercial_count }} </td>
    </ng-container>
    <ng-container matColumnDef="municipal_count">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <span class="plotCount">{{ district.municipal_count }} x</span>
        <img src="https://play.mcp3d.com/assets/images/buildings/Hospital_V2_LVL1-1.png" height="30" />
        <span class="long-text">Municipal</span><span class="short-text">M</span>
      </th>
      <td mat-cell *matCellDef="let ownerSummary">  {{ ownerSummary.municipal_count }} </td>
    </ng-container>


    <tr mat-header-row *matHeaderRowDef="displayedColumnsOwners; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumnsOwners;"></tr>
  </table>

</div>
